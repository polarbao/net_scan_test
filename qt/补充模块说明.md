# Qt项目补充模块说明

## 一、已补充的模块

### 1. 线程模块
- ✅ **MonitorThread** - 监控线程
  - 文件: `MonitorThread.h/cpp`
  - 功能: 持续监控设备状态（温度、电压、连接状态等）
  - 对应MFC: `MonitorThread` 静态函数

### 2. 对话框模块
- ✅ **PrintJobDialog** - 打印作业对话框
  - 文件: `PrintJobDialog.h/cpp`
  - 功能: 打印作业参数配置（DPI、位置、镜像等）
  - 对应MFC: `CPrtJobDlg`

- ✅ **SysParamDialog** - 系统参数对话框
  - 文件: `SysParamDialog.h/cpp`
  - 功能: 系统参数配置（打印头参数、微喷参数、闪喷参数等）
  - 对应MFC: `CSysParamDlg`
  - 注意: 需要根据实际UI设计完善控件绑定

### 3. 自定义控件模块
- ✅ **ImagePreviewWidget** - 图像预览控件
  - 文件: `ImagePreviewWidget.h/cpp`
  - 功能: 图像预览显示和位图绘制
  - 对应MFC: `CPicScreen`
  - 完善: 已实现基本功能，支持BMP格式，PRT/CLI格式需要特殊处理

- ✅ **PrintInfoTreeWidget** - 打印信息树形控件
  - 文件: `PrintInfoTreeWidget.h/cpp`
  - 功能: 树形结构数据展示和多列数据显示
  - 对应MFC: `CSWListTreeCtrl`
  - 完善: 已实现基本功能，需要根据实际需求完善VT列表更新

### 4. 应用程序入口
- ✅ **main.cpp** - 应用程序入口
  - 文件: `main.cpp`
  - 功能: 应用程序初始化和主窗口创建
  - 对应MFC: `CNetScanDemoApp::InitInstance()`

## 二、仍需补充的模块

### 2.1 对话框模块（中低优先级）
- [ ] **ImgLayerSetDialog** - 图像图层设置对话框
  - 对应MFC: `CImgLayerSetDlg`
  - 功能: 图像图层参数配置（DPI、打印方向、羽化模式等）

- [ ] **VTSetDialog** - VT设置对话框
  - 对应MFC: `CVTSetDlg`
  - 功能: VT（电压/温度）参数设置

- [ ] **AdjParamDialog** - 调整参数对话框
  - 对应MFC: `CAdjParamDlg`
  - 功能: 打印参数调整和校准参数设置
  - 注意: 包含打印校准线程

- [ ] **ReloadWaveDialog** - 重载波形对话框
  - 对应MFC: `CReloadWaveDlg`
  - 功能: 打印头波形重载和波形文件管理

- [ ] **MoveCtlDialog** - 运动控制对话框（可选）
  - 对应MFC: `CMoveCtlDlg`
  - 功能: 运动系统控制
  - 条件: 需要定义 `RY_MOVE_CTL` 宏

- [ ] **AirInkDialog** - 气墨控制对话框
  - 对应MFC: `CAirInkDialog`
  - 功能: 气墨系统控制

- [ ] **AdibCtrlDialog** - ADIB控制对话框
  - 对应MFC: `CAdibCtrlDlg`
  - 功能: ADIB（自适应数字墨水总线）控制

- [ ] **LackJetDialog** - 缺喷检测对话框
  - 对应MFC: `CLackJetDlg`
  - 功能: 缺喷检测设置和喷头状态监控

### 2.2 自定义控件模块（低优先级）
- [ ] **InkStateWidget** - 墨水状态控件
  - 对应MFC: `CInkStateCtrl`
  - 功能: 墨水状态显示和逻辑输入状态显示

- [ ] **ImportListWidget** - 导入列表控件
  - 对应MFC: `CImportListCtrl`
  - 功能: 列表数据展示和数据导入功能

### 2.3 工具类
- [ ] **ImageLoader** - 图像加载工具类
  - 功能: 图像文件加载（BMP/PRT/CLI格式）
  - 对应MFC: `GetSrcData()` 函数
  - 注意: 需要实现PRT和CLI格式的解析

## 三、使用说明

### 3.1 编译顺序
1. 先编译基础模块: `ParameterManager`, `MonitorThread`, `PrintThread`
2. 再编译控件模块: `ImagePreviewWidget`, `PrintInfoTreeWidget`
3. 然后编译对话框模块: `PrintJobDialog`, `SysParamDialog`
4. 最后编译主窗口: `MainWindow`
5. 编译应用程序入口: `main.cpp`

### 3.2 UI文件创建
所有对话框都需要创建对应的 `.ui` 文件：
- `PrintJobDialog.ui`
- `SysParamDialog.ui`
- 等等

可以使用Qt Designer创建这些UI文件。

### 3.3 注意事项

1. **全局变量**: 所有全局变量定义在 `main.cpp` 中，与MFC版本保持一致

2. **线程安全**: 
   - 使用Qt信号槽进行线程间通信
   - 避免在工作线程中直接操作UI

3. **参数同步**: 
   - 对话框关闭时保存参数到全局变量
   - 主窗口初始化时从全局变量加载参数

4. **错误处理**: 
   - 添加适当的错误处理和用户提示
   - 使用 `QMessageBox` 显示错误信息

5. **编码问题**: 
   - Qt使用UTF-8编码
   - 与Windows API交互时注意编码转换

## 四、下一步工作

1. **完善已有模块**: 
   - 完善 `SysParamDialog` 的UI绑定
   - 完善 `PrintInfoTreeWidget` 的VT列表更新
   - 完善 `ImagePreviewWidget` 的PRT/CLI格式支持

2. **创建UI文件**: 
   - 使用Qt Designer创建所有对话框的UI文件
   - 设置控件名称和布局

3. **实现剩余对话框**: 
   - 按照优先级实现剩余的对话框
   - 参考MFC版本的实现逻辑

4. **测试和调试**: 
   - 逐个模块测试功能
   - 确保与MFC版本功能一致

5. **优化和重构**: 
   - 优化代码结构
   - 添加错误处理
   - 改进用户体验

